Express框架的app.js经典的结构就是下面几部分

 - 加载依赖
 - 实例化对象
 - 项目配置（app.set()）
 - 中间件
 - 路由分发
 - 启动和错误处理

这一节我们稍微讲解第五个步骤路由分发,以及路由分发过程中几个重要的参数,req,res
这些必须的参数非常重要.他接受来自客户端从url或者http请求中传递过来的参数.如果我们不依赖Express框架配合第三方库（如cookie-parser,body-parser）,我们就必须要调用Node核心原生模块来解析url或者http的参数.

##路由参数
第一种抓取url参数的方法就是在请求处理函数中操作获取url的值.如果大部分逻辑相同的话你可以抽象出一个函数.简单的举个例子获取用户的信息,就需要去数据库去load.在userPage页面和admin页面都有这一段逻辑.于是我们就有了下面的这段代码

        var user={
            'Jacky':{
                email:'493648377@qq.com',
                blog:'http://www.baidu.com'
            }
        }
假设用户信息来自于数据库,因为有相同的逻辑我们可以抽象出一个函数来做统一的处理.

        var findUserByUsername=function(username,callback){
            if(!user[username]){
                return callback(new Error('not user found'))
            }
            return callback(null,user[username])
        }
        
这个时候在请求处理函数中

        app.get('/userPage/:username',function(req,res,next){
            var username=req.params.username
            findUserByUsername(username,function(err,user){
                if(err) return next(err)
                return res.render('userPage',user)
            })
        })
        
        app.get('/admin/:username',function(req,res,next){
            var username=req.params.username
            findUserByUsername(username,function(err,user){
                if(err) return next(err)
                return res.render('admin',user)
            })
        })
        
如果没找到的话就会抛一个Error出来,在请求处理函数中next()方法把err抛给errorhandler处理.
